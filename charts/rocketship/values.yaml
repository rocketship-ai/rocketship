# Default values for Rocketship Helm chart.
# This chart deploys the Rocketship engine and worker. A Temporal cluster must
# already be available and reachable via the configured host.

nameOverride: ""
fullnameOverride: ""

imagePullSecrets: []

podAnnotations: {}

podSecurityContext: {}

securityContext: {}

temporal:
  # Hostname:port of the Temporal frontend service. The default assumes you
  # install Temporal into the "rocketship" namespace with release name "temporal".
  # Override as needed or set via --set temporal.host=...
  host: "temporal-frontend.rocketship:7233"
  namespace: "default"

auth:
  mode: ""
  oidc:
    enabled: false
    mode: ""
    issuer: ""
    clientID: ""
    audience: ""
    tokenEndpoint: ""
    deviceEndpoint: ""
    jwksURL: ""
    scopes: []
    allowedAlgorithms: []

# Controlplane (Cloud API) configuration
controlplane:
  enabled: false
  image:
    repository: rocketshipai/rocketship-controlplane
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8080
    annotations: {}
  issuer: ""
  audience: ""
  clientID: ""
  scopes: []
  github:
    clientID: ""
    clientSecretSecret: ""
    clientSecretKey: github-client-secret
    scopes: []
  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts: []
    tls: []
  signingKey:
    secretName: ""
    key: signing-key.pem
    mountPath: /var/run/rocketship
    fileName: signing-key.pem
  database:
    url: ""
    secretName: ""
    secretKey: database-url
  refreshTokenKey:
    secretName: ""
    secretKey: controlplane-refresh-key
    value: ""
  env: []
  envFrom: []
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

postgres:
  enabled: false
  auth:
    username: rocketship
    password: ""
    database: rocketship
  primary:
    persistence:
      enabled: true
      size: 8Gi

engine:
  replicaCount: 1
  image:
    repository: rocketshipai/rocketship-engine
    tag: latest
    pullPolicy: IfNotPresent
  env: []
  database:
    url: ""
    secretName: ""
    secretKey: database-url
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  service:
    type: ClusterIP
    annotations: {}
    grpcPort: 7700
    httpPort: 7701

worker:
  replicaCount: 1
  image:
    repository: rocketshipai/rocketship-worker
    tag: latest
    pullPolicy: IfNotPresent
  env: []
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: rocketship.example.com
      paths:
        - path: /
          pathType: Prefix
  tls: []

web:
  enabled: false
  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts: []
    tls: []
  oauth2Proxy:
    enabled: false
    replicaCount: 1
    image:
      repository: quay.io/oauth2-proxy/oauth2-proxy
      tag: v7.6.0
      pullPolicy: IfNotPresent
    service:
      type: ClusterIP
      port: 4180
    upstreamOverride: ""
    extraArgs:
      - --http-address=0.0.0.0:{{ .Values.web.oauth2Proxy.service.port }}
      - --https-address=:0
      - --cookie-secure=true
      - --cookie-samesite=lax
      - --set-authorization-header=true
      - --pass-authorization-header=true
      - --pass-access-token=true
      - --set-xauthrequest=true
    env: []
    envFrom: []
    podAnnotations: {}
    podLabels: {}
    resources: {}
    nodeSelector: {}
    tolerations: []
    affinity: {}

# GitHub webhook relay (smee.io -> controlplane for local dev)
githubWebhookRelay:
  enabled: false
  secretName: rocketship-github-webhook
