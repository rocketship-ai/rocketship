name: "Visual Browser Test"
tests:
  - name: "See persistent session in action"
    steps:
      - name: "start browser with GUI"
        plugin: playwright
        config:
          role: start
          session_id: "visual-demo-{{ .run.id }}"
          headless: false  # ğŸ‘€ Browser will be visible!

      - name: "navigate to Google"
        plugin: playwright
        config:
          role: script
          session_id: "visual-demo-{{ .run.id }}"
          language: python
          script: |
            print("ğŸŒ Navigating to Google...")
            page.goto("https://www.google.com")
            title = page.title()
            print(f"âœ… Page title: {title}")

            # Fill search box (you'll see this happen!)
            search_box = page.locator("textarea[name='q']")
            search_box.fill("Rocketship AI testing")
            print("âŒ¨ï¸  Typed in search box")

            import time
            time.sleep(2)  # Pause so you can see it
            result = {"title": title}

      - name: "search and wait"
        plugin: playwright
        config:
          role: script
          session_id: "visual-demo-{{ .run.id }}"
          language: python
          script: |
            print("ğŸ” Clicking search button...")
            page.keyboard.press("Enter")
            page.wait_for_load_state("networkidle")

            print("ğŸ“„ Waiting on results page...")
            import time
            time.sleep(3)  # Let you see the results

            url = page.url
            print(f"âœ… Current URL: {url}")
            result = {"url": url}

      - name: "navigate to example.com"
        plugin: playwright
        config:
          role: script
          session_id: "visual-demo-{{ .run.id }}"
          language: python
          script: |
            print("ğŸ¯ Navigating to example.com...")
            page.goto("https://example.com")

            # Get the heading text
            heading = page.locator("h1").text_content()
            print(f"ğŸ“ Heading: {heading}")

            import time
            time.sleep(2)  # Pause
            result = {"heading": heading}

      - name: "stop browser"
        plugin: playwright
        config:
          role: stop
          session_id: "visual-demo-{{ .run.id }}"
