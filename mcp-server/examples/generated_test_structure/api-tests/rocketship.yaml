name: API Integration Tests
description: Comprehensive API endpoint testing
vars:
  api_base: "{{ .vars.base_url }}"
  auth_header: "{{ .vars.auth.api_key }}"
tests:
  - name: API Health Check
    steps:
      - name: Health endpoint
        plugin: http
        config:
          method: GET
          url: "{{ .vars.api_base }}/health"
          timeout: "{{ .vars.timeout }}s"
        assertions:
          - type: status_code
            expected: 200
  - name: Test GET /api/v1/users
    steps:
      - name: GET request to /api/v1/users
        plugin: http
        config:
          method: GET
          url: "{{ .vars.api_base }}/api/v1/users"
          headers:
            Authorization: "Bearer {{ .vars.auth_token }}"
        assertions:
          - type: status_code
            expected: 200
  - name: Test POST /api/v1/users
    steps:
      - name: POST request to /api/v1/users
        plugin: http
        config:
          method: POST
          url: "{{ .vars.api_base }}/api/v1/users"
          headers:
            Authorization: "Bearer {{ .vars.auth_token }}"
          body:
            example: data
        assertions:
          - type: status_code
            expected: 201
  - name: Test GET /api/v1/users/{id}
    steps:
      - name: GET request to /api/v1/users/{id}
        plugin: http
        config:
          method: GET
          url: "{{ .vars.api_base }}/api/v1/users/{id}"
          headers:
            Authorization: "Bearer {{ .vars.auth_token }}"
        assertions:
          - type: status_code
            expected: 200